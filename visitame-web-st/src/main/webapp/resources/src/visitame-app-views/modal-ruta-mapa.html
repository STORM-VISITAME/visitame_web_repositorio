<link rel="import" href="../../bower_components/polymer/polymer-element.html">
<link rel="import" href="../../bower_components/paper-dialog/paper-dialog.html">
<link rel="import" href="../../bower_components/paper-button/paper-button.html">
<link rel="import" href="../../bower_components/iron-icon/iron-icon.html">
<link rel="import" href="../../bower_components/iron-icons/iron-icons.html">

<link rel="import" href="../visitame-app-styles/leyenda-style.html">
<dom-module id="modal-ruta-mapa">
    <template>
      
  		<style include="leyenda-style"></style>
        
 		<meta charset="utf-8">
        <paper-dialog  class="ventana roundbox boxshadow" id="rutaMapa" style="text-align:center;" entry-animation="scale-up-animation" exit-animation="fade-out-animation" with-backdrop>
            <div
				style="width: 90%; height: 100%; display: inline-block; padding: 0px;">
				<div style="width: 100%; font-size: 1.4em;">Llega con:</div>
				<div style="height: 40px; width: 250px; margin-top: 15px;">
					<paper-button src="{{pathParent}}images/googleMap.jpg" on-tap="abritGoogleMap" style="text-transform: capitalize;">
						<iron-icon src="{{pathParent}}images/googleMap.jpg" style="margin-right: 2px;" ></iron-icon>
						Google maps
					</paper-button>
				</div>

				<div style="height: 40px; width: 198px; ">
					<paper-button src="{{pathParent}}images/waze.jpg" on-tap="abrirMapaWaze" style="text-transform: capitalize;">
						<iron-icon src="{{pathParent}}images/waze.jpg"  style="margin-right: 2px;"  ></iron-icon>
						Waze
					</paper-button>		
				</div>
				<div style="width: 100%; margin-top: 3%; font-size: 0.7em; color: darkblue;">*Debes tener instalada la aplicación que elijas.</div>
				<div style="width: 100%;">
					<paper-button class="aceptar" on-click="cerrar" style="margin-top: 6px;" >Cancelar</paper-button>
				</div>
			</div>
        </paper-dialog>
    </template>
    <script>
        class ModalRutaMapa extends Polymer.Element {
            static get is() {
                return 'modal-ruta-mapa';
            }
   
            static get properties() {
                return {
                    pathParent: {
                        type: String,
                        value: dirStatic+'/'
                    },
                
                	mapa : {
						type: Object
              		}
                };
            }
            ready() {
                super.ready();
                if (!localStorage.getItem("leyenda") || localStorage.getItem("leyenda") == "0") {
                    this.$.animated.open();
                }
            }

            abritGoogleMap() {
            	  if(this.getMapa().detalleOficina){
      	    	  	let latitudeActual  = this.getMapa().$.parametrosConfiguracion.getParametros().posicionActual.latitude;
      	    	  	let longitudeActual= this.getMapa().$.parametrosConfiguracion.getParametros().posicionActual.longitude;
      	    	  	let latitudeIr = this.getMapa().detalleOficina.latitude;
      	    	  	let longitudeIr = this.getMapa().detalleOficina.longitude;
      	    	  	
      	    	  	window.open("http://maps.google.com/maps?saddr="+latitudeActual+","+longitudeActual+"&daddr="+latitudeIr+","+longitudeIr,'_blank'); 
      			  //	window.location="http://maps.google.com/maps?saddr="+latitudeActual+","+longitudeActual+"&daddr="+latitudeIr+","+longitudeIr;
      	    	  }else{
      	    		  console.log("Detalle de Oficina Seleccionada no se encontró");
      	    	  }
            }
            
            abrirMapaWaze() {
            	if(this.getMapa().detalleOficina){
      	    	  	let latitudeActual  = this.getMapa().$.parametrosConfiguracion.getParametros().posicionActual.latitude;
      	    	  	let longitudeActual= this.getMapa().$.parametrosConfiguracion.getParametros().posicionActual.longitude;
      	    	  	let latitudeIr = this.getMapa().detalleOficina.latitude;
      	    	  	let longitudeIr = this.getMapa().detalleOficina.longitude;
      	    	  	
      	    	  	window.open("https://waze.com/ul?ll="+latitudeActual+","+longitudeActual+"&z=10&navigate=yes",'_blank'); 
      			  //	window.location="http://maps.google.com/maps?saddr="+latitudeActual+","+longitudeActual+"&daddr="+latitudeIr+","+longitudeIr;
      	    	  }else{
      	    		  console.log("Detalle de Oficina Seleccionada no se encontró");
      	    	  }
            }
            
            abrir() {
            	 this.$.rutaMapa.open();
            }
            
            setMapa(mapa){
            	this.mapa = mapa;
            }
            
            getMapa(){
            	return this.mapa;
            }
            
            cerrar() {
           	 this.$.rutaMapa.close();
           }

        }
        window.customElements.define(ModalRutaMapa.is, ModalRutaMapa);
    </script>
</dom-module>